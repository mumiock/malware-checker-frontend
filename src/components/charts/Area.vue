<template>
  <div :class="containerClass">
    <canvas id="mychartarea" ref="chart"></canvas>
  </div>
</template>

<script>
import { ref, onMounted } from "vue";
import { Chart, registerables } from "chart.js";

Chart.register(...registerables);

export default {
  props: {
    data: {
      type: Object,
    },
    containerClass: {
      type: String,
      default: "chart-container",
    },
    shadow: {
      type: Boolean,
      default: false,
    },
  },
  setup(props) {
    const chartRef = ref(null);

    onMounted(() => {
      const canvas = document.getElementById("mychartarea");
      chartRef.value = canvas.getContext("2d");

      const chartTooltip = {
        backgroundColor: "#cfe2f3",
        titleFontColor: "#9db7e5",
        borderColor: "#6291a9",
        borderWidth: 0.5,
        bodyFontColor: "#ffecc6",
        bodySpacing: 10,
        xPadding: 15,
        yPadding: 15,
        cornerRadius: 0.15,
      };
      const areaChartOptions = {
        legend: {
          display: false,
        },
        responsive: true,
        maintainAspectRatio: false,
        tooltips: chartTooltip,
        scales: {
          yAxes: [
            {
              gridLines: {
                display: true,
                lineWidth: 1,
                color: "rgba(0,0,0,0.1)",
                drawBorder: false,
              },
              ticks: {
                beginAtZero: true,
                stepSize: 5,
                min: 50,
                max: 70,
                padding: 20,
              },
            },
          ],
          xAxes: [
            {
              gridLines: {
                display: false,
              },
            },
          ],
        },
      };

      const ctx = chartRef.value;
      const myChart = new Chart(ctx, {
        type: props.shadow ? "lineWithShadow" : "line",
        data: props.data,
        options: areaChartOptions,
      });
    });

    return {
      chartRef,
    };
  },
};
</script>
